<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" type="text/css" href="../../marvinmanuals.css"
	title="style">
<title>Evaluator Examples</title>
</head>
<body>
	<h1>Evaluator Examples</h1>

	<h2>Contents</h2>
	<ul>
		<li><a href="#intro">Introduction</a></li>
		<li><a href="#prereq">Prerequisites</a></li>
		<li><a href="#basic_examples">Basic examples</a></li>
		<li><a href="#reaction_examples">Reaction rule examples</a></li>
		<li><a href="#search_examples">Search filtering examples</a></li>
		<li><a href="../../help/chemicalterms/EvaluatorTables.html"
			target="_blank">Chemical Terms Reference Tables</a></li>
	</ul>
	
		<div class="lenia"></div>
	

	<h2>
		<a class="anchor" id="intro"></a>Introduction
	</h2>

	<p>
		These examples show the application of <a
			href="../../help/chemicalterms/ChemicalTerms.html">ChemAxon's
			Chemical Terms</a> in various ChemAxon products. First we look at some
		basic examples showing chemical expressions formulated with input read
		from a <a
			href="../../help/chemicalterms/ChemicalTerms.html#molcontext">molecule
			context</a>, which applies to the <a
			href="../../help/chemicalterms/Evaluator.html">Evaluator</a> command
		line tool and chemical expression evaluation and filtering in <a
			href="http://www.chemaxon.com/jchem/doc/guide/cartridge/index.html">JChem
			Cartridge</a>. Next we demonstrate the strength of the chemical terms
		language in formulating reaction rules, where input is taken from a <a
			href="../../help/chemicalterms/ChemicalTerms.html#reactioncontext">reaction
			context</a>. Finally we show how to select <a
			href="http://www.chemaxon.com/jchem/doc/user/Jcsearch.html">search
			hits</a> by formulating <a
			href="http://www.chemaxon.com/jchem/doc/user/Jcsearch.html#expression">search
			filters</a> referring to a <a
			href="../../help/chemicalterms/ChemicalTerms.html#searchcontext">search
			context</a> containing the target and query molecules together with the
		current search hit.
	</p>
	<p>
		Throughout the examples, use the set of <a
			href="../../help/chemicalterms/EvaluatorTables.html" target="_blank">Chemical
			Terms Reference Tables</a> to look at the function and plugin calculation
		syntax together with some generic examples.
	</p>

			<div class="lenia">&nbsp;</div>
	
	<h2>
		<a class="anchor" id="prereq"></a>Prerequisites
	</h2>

	<p>To run these examples:</p>

	<ol>
		<li>The <a href="http://java.sun.com/products">Java Virtual
				Machine</a> version 1.4 or higher and Marvin / JChem have to be
			installed on your system.
		</li>
		<li>The <code>PATH</code> environment variable have to be set as
			described in the <a href="../../help/applications/installguide.html">Installation
				Guide for Marvin Beans</a> manual.
		</li>
		<li>A command shell (under UNIX / Linux: your favorite shell,
			under Windows: a <a href="http://www.cygwin.com/">Cygwin</a> shell or
			a Command Prompt) has to be run in the evaluator example directory. <br>In
			UNIX / Linux: <pre>
cd marvin/examples/evaluator
</pre> In Windows: <pre>
cd marvin\examples\evaluator
</pre>
		</li>
	</ol>

	
		<div class="lenia">&nbsp;</div>


	<h2>
		<a class="anchor" id="basic_examples"></a>Basic examples
	</h2>

	<p>
		These examples refer to a <a
			href="../../help/chemicalterms/ChemicalTerms.html#molcontext">molecule
			context</a> and applies to the <a
			href="../../help/chemicalterms/Evaluator.html">Evaluator</a> command
		line tool and chemical expression evaluation and filtering in <a
			href="http://www.chemaxon.com/jchem/doc/guide/cartridge/index.html">JChem
			Cartridge</a>. The working examples below use the
		<code>evaluate</code>
		tool but the same expressions can be used in <a
			href="http://www.chemaxon.com/jchem/doc/guide/cartridge/index.html">JChem
			Cartridge</a> - but only
		<code>boolean</code>
		expressions (evaluated to
		<code>true</code>
		or
		<code>false</code>
		) can be used for setting a <a
			href="http://www.chemaxon.com/jchem/doc/guide/cartridge/cartapi.html#jc_compare_ctFilter">filtering
			condition</a>.
	</p>

	<p>
		Our input molecules are stored in
		<!--dead link-->
		<a href="aroms.smiles">aroms.smiles</a> and shown below:
	</p>

	<p></p>
	<table align="center" border="0" cellspacing="0" cellpadding="5">
		<caption>
			<small><b><a href="aroms.smiles">input molecules</a></b></small>
		</caption>
		<tr>
			<td><img border="0" src="img/aroms.png" width="517" height="495"
				alt=""></td>
		</tr>
	</table>

	<p>
		This will be the first reactant set in the <a href="#friedel">Friedel-Crafts
			acylation</a> reaction in the <a href="#reaction_examples">Reaction
			examples</a> section. Now we start with some simple plugin calculations
		and proceed towards the <a href="#friedel-exclude">exclude rule</a> of
		the reaction. The first and last molecules are the same (benzene)
		because we will react benzene with two different <a
			href="#acid-halides">acid-halides</a> when processing the <a
			href="#friedel">Friedel-Crafts acylation</a>.
	</p>

	<ul>
		<li>You can evaluate some simple molecule properties returning a
			single number by evaluating the following, one-by-one: <pre>
ringCount()
aromaticRingCount()
chainAtomCount()
smallestRingSize()
bondCount()
mass()
</pre> You can find many more in the <a
			href="../../help/chemicalterms/EvaluatorTables.html#plugindesc">structure
				based calculations reference tables</a>. For command line access, run <a
			href="../../help/chemicalterms/Evaluator.html">Evaluator</a> by
			simply typing: <pre>
evaluate -e "ringCount()" aroms.smiles
</pre> and you will get the number of rings for each input molecule: <pre>
1
1
1
1
1
1
3
2
1
1
1
1
1
1
</pre> You can print the results of the others above in a similar way.

			<p></p>
		</li>
		<li>There are other calculations that compute a single numeric
			value for the input molecule: <pre>
avgPol()
logp()
psa()
</pre> which compute the average molecular polarizability component
			considering 3D geometry, the log<i>P</i> and the topological polar
			surface area, resp. <a class="anchor" id="psaex"></a><a
			href="../../help/chemicalterms/Evaluator.html">Evaluator</a> example:
			<pre>
evaluate -e "psa()" aroms.smiles
</pre> will give the following results: <pre>
0
17.07
45.82
0
0
0
0
15.79
20.23
20.23
26.02
26.02
29.1
0
</pre>

			<p></p>
		</li>
		<li>Atomic plugin calculations, when called for the molecule as a
			whole, return an array containing the calculation result for each
			atom: <pre>
charge()
pka()
energyE()
polarizability()
</pre> <a href="../../help/chemicalterms/Evaluator.html">Evaluator</a>
			example: <pre>
evaluate -e "energyE()" aroms.smiles
</pre> In the result display array elements are separated by ';' characters,
			invalid values (<code>NaN</code> not-a-number values, returned when
			there is no result returned by the calculations for the atom - in
			case of <code>energyE()</code> these are the non-aromatic atoms) are
			represented by empty strings: <pre>
2.54;2.54;2.54;2.54;2.54;2.54
;0.5;3.78;1.57;1.05;0.99;1.21;0.99;1.05
1.73;-0.02;1.73;0.7;0.29;0.19;0.3;0.19;0.29
1.84;2.77;2.27;2.54;2.31;2.54;2.27
3.03;2.57;2.51;2.54;2.51;2.54;2.51
3.03;2.57;2.48;2.54;2.48;2.57;3.03;2.48
2.42;2.42;2.23;3.03;2.01;3.03;2.23;2.42;2.42;2.23;3.03;2.01;3.03;2.23
3.88;3.87;3.76;4.31;3.99;3.85;3.43;4.33;3.74
4.2;1.73;1.45;1.56;1.46;1.56;1.45
4.02;2.24;1.77;1.26;1.55;1.3;1.55;1.26
1.55;3.09;1.98;2.55;2.06;2.55;1.98
;2.29;1.07;2.26;1.8;2.05;1.83;2.05;1.8
;0.82;4.12;3.1;1.83;1.2;1.42;1.25;1.42;1.2
2.54;2.54;2.54;2.54;2.54;2.54
</pre>

			<p></p>
		</li>
		<li>To perform the plugin calculation for specific atom(s), you
			should specify the corresponding atom index list as parameter(s): <pre>
charge(0)
pka(0, 1)
energyE(2, 3, 4)
polarizability(2)
</pre>

			<p></p>
		</li>
		<li>You can also give other, plugin specific parameters. For
			example, you can ask for acidic p<i>K</i><sub>a</sub> values for each
			atom or for specified atoms by: <pre>
pka('acidic')
pka(0, 2, 3,  'acidic')
</pre>

			<p></p>
		</li>
		<li>Another typical structure based calculation parameter is the
			pH. For some plugin calculations, if the pH is specified, then the
			plugin calculates with the physiological microspecies of the input
			molecule at the given pH. Examples: <pre>
charge('7.4')
charge('7.4', 0)
energyE('6.5', 2, 3)
psa('9.4')
</pre> Note, that the pH value is always enclosed in quotes, while atom
			indices are specified as integral numbers. For example, typing <pre>
evaluate -e "psa('9.4')" aroms.smiles
</pre> gives the following: <pre>
0
17.07
45.82
0
0
0
0
15.79
20.23
20.23
26.02
27.64
29.1
0
</pre> which differs from the results received for the input molecule itself
			for two molecules (compare with the <a href="#psaex">PSA
				calculation example</a> above).

			<p></p>
		</li>
		<li>For log<i>D</i> the pH value simply means the pH where the
			log<i>D</i> is to be taken, for example: <pre>
logd('7.4')
</pre>

			<p></p></li>
		<li>Another specific building block of chemical expressions is
			the set of substructure search functions. Currently we have two such
			functions:
			<ol>
				<li><code>match()</code> tests substructure matching and
					returns <code>true</code> or <code>false</code> depending on the
					search result.</li>
				<li><code>matchCount()</code> counts the search hits and
					returns this numerical result</li>
			</ol> Both functions have the same parametrization:
			<ul>
				<li>the target molecule (by default, this is the input
					molecule)</li>
				<li>optional target atom indices to be matched</li>
				<li>the query molecule (mandatory)</li>
				<li>optional query maps to be matched</li>
			</ul> You can find a summary on the usage of these match functions in the
			<a href="../../help/chemicalterms/EvaluatorTables.html#matchdesc">Match
				Reference Tables</a>. For example, test whether the input molecule
			contains an <code>O</code> or an <code>S</code> atom with a single
			hydrogen, write: <pre>
match('[O,S;H1]')
</pre> To count these atoms, write: <pre>
matchCount('[O,S;H1]')
</pre> Now take a <code>N</code>, aliphatic or aromatic, with at least one
			attached hydrogen: <pre>
match('[#7][H]')
matchCount('[#7][H]')
</pre> <a href="../../help/chemicalterms/Evaluator.html">Evaluator</a>
			example: <pre>
evaluate -e "match('[#7][H]')" aroms.smiles
</pre> The result is: <pre>
0
0
0
0
0
0
0
1
0
0
1
1
1
0
</pre> Note, that <code>true</code> is treated and displayed as a numerical <code>1</code>
			and <code>false</code> as a numerical <code>0</code>. This is useful
			when you test a rule like <a href="#bioavailability">bioavailability</a>
			where you require that at least a certain number of the specified
			conditions should be satisfied.
			<p>
				You can use the
				<code>-x, --extract &lt;format&gt;</code>
				option to filter the input and output precisely those molecules
				which satisfy the boolean expression:
			</p>
			<pre>
evaluate -e "match('[#7][H]')" -x smiles aroms.smiles
</pre> The result is: <pre>
c1ccc2[nH]ccc2c1
Nc1ccccc1
CC(N)c1ccccc1
CC(=O)Nc1ccccc1
</pre>
			<p>To test atom-by-atom matches, you should refer to a target
				atom by its atom index (0-based) and possibly one or more query
				maps. For example,</p>
			<pre>
match(2, '[#8]C=O')
</pre> will test whether target atom <code>2</code> is part of a carboxylic
			group, while <pre>
match(2, '[#8:1]C=[O:2]', 1)
</pre> will test whether target atom <code>2</code> is a carboxylic <code>OH</code>,
			and <pre>
match(2, '[#8:1]C=[O:2]', 1, 2)
</pre> will test whether target atom <code>2</code> is a carboxylic oxygen.
			Note, that the target atom index should be written in front of the
			query, while the query atom map(s) should follow the query. However,
			in most cases, the target atom is not specified by explicitely
			writing an atom index, since we do not know the aotm order in the
			target. Instead, the target atom usually comes from another context,
			such as <code>ratom(i)</code> or <code>patom(i)</code> from a <a
			href="../../help/chemicalterms/ChemicalTerms.html#reactioncontext">reaction
				context</a> or else a superior function iterates through all atoms and
			collects those that satisfy the match condition. The most typical
			example for such a function is the <code>filter()</code> function
			explained below.
			<p>You can also use logical operators to form to include two or
				more substructure search results:</p>
			<pre>
match('[O,S;H1]') || match('[#7][H]')
</pre> will test for matching any of <code>OH</code>, <code>SH</code> or a
			nitorgen with at least one attached hydrogen: <pre>
 evaluate -e "match('[O,S;H1]') || match('[#7][H]')" aroms.smiles
</pre> the result is: <pre>
0
0
0
0
0
0
0
1
1
1
1
1
1
0
</pre> while <pre>
match('[O,S;H1]') && match('[#7][H]')
</pre> will test for matching both an <code>OH</code> or <code>SH</code> and a
			nitorgen with at least one attached hydrogen.
			<p>Furthermore, you can add the number of search hits to count
				all the above functional groups:</p>
			<pre>
matchCount('[O,S;H1]') + matchCount('[#7][H]')
</pre>



			<p></p>
		</li>
		<li>The <a
			href="../../help/chemicalterms/EvaluatorTables.html#filterdesc">filter
				function</a> takes a <code>boolean</code> subexpression as argument,
			iterates through the atoms of the input molecule and evaluates this
			inner subexpression for each atom. The result is an atom index array
			containing the atom indices satifying the inner subexpression. For
			example, <pre>
filter("charge() &gt; 0")
</pre> returns the indices of atoms with positive partial charge. Test this
			with the <a href="../../help/chemicalterms/Evaluator.html">Evaluator</a>:
			<pre>
evaluate -e "filter('charge() &gt; 0')" aroms.smiles
</pre> The result is: <pre>
 
1
3;4;8
 
 
 
 
 
 
1
 
1
0;1
 
</pre> with empty rows meaning no positive partial charge for that molecule.
			You can check the charge values by simply typing: <pre>
evaluate -e "charge()" aroms.smiles
</pre>
			<p>
				Another typical example for an inner condition is the
				<code>match()</code>
				function:
			</p>
			<pre>
filter("match('[#8:1]C=[O:2]', 1, 2)")
</pre> will list all carboxylic oxygens in the input molecule, while <pre>
filter("match('[#7:1][H]', 1)")
</pre> will list all nitrogen atoms with at least one attached hydrogen. To
			test this, type: <pre>
evaluate -e "filter(\"match('[#7:1][H]', 1)\")" aroms.smiles
</pre> Note, that you can nest single and double quotes but if you need more
			than two then you should escape the inner quotes identical to the
			outer quotes. To escape this problem, you can save your filter in a
			file and switch to the <code>-f</code> option: <pre>
evaluate -e filter.txt aroms.smiles
</pre> The result is: <pre>
 
 
 
 
 
 
 
4
 
 
0
2
3
 

</pre> that is, there are four input molecules containing a nitrogen atom with
			an attached hydrogen, and all of these contain only one such atom.
			<p>As another example, you can list aromatic carbons by:</p>
			<pre>
evaluate -e "filter(\"match('c')\")" aroms.smiles
</pre> The resulting atom index arrays are displayed as comma-separated lists:
			<pre>
0;1;2;3;4;5
3;4;5;6;7;8
3;4;5;6;7;8
1;2;3;4;5;6
1;2;3;4;5;6
1;2;3;4;5;7
0;1;2;3;4;5;6;7;8;9;10;11;12;13
0;1;2;3;5;6;7;8
1;2;3;4;5;6
2;3;4;5;6;7
1;2;3;4;5;6
3;4;5;6;7;8
4;5;6;7;8;9
0;1;2;3;4;5
</pre>

			<p></p></li>
		<li>You can evaluate atomic plugin calculations on these filtered
			atoms. For example, <pre>
evaluate -e "charge(filter(\"match('c')\"))" aroms.smiles 
</pre> will return the partial charges on aromatic carbons: <pre>
-0.06;-0.06;-0.06;-0.06;-0.06;-0.06
-0.02;-0.02;-0.05;-0.04;-0.05;-0.02
0.03;0.03;-0.03;-0.03;-0.03;0.03
-0.06;-0.07;-0.06;-0.07;-0.06;-0.07
-0.02;-0.04;-0.05;-0.06;-0.05;-0.04
-0.02;-0.03;-0.05;-0.03;-0.02;-0.01
-0.06;-0.06;-0.05;-0.04;-0.03;-0.04;-0.05;-0.06;-0.06;-0.05;-0.04;-0.03;-0.04;-0.05
-0.05;-0.05;-0.04;-0.09;-0.11;-0.04;-0.04;-0.04
-0.01;-0.06;-0.06;-0.1;-0.06;-0.06
-0.04;-0.05;-0.06;-0.06;-0.06;-0.05
-0.04;-0.07;-0.07;-0.09;-0.07;-0.07
-0.05;-0.05;-0.06;-0.06;-0.06;-0.05
-0.02;-0.04;-0.05;-0.06;-0.05;-0.04
-0.06;-0.06;-0.06;-0.06;-0.06;-0.06
</pre>

			<p></p>
		</li>
		<li>You can apply various array functions for the above results,
			for example, you can take the sum of these charges by: <pre>
evaluate -e "sum(charge(filter(\"match('c')\")))" aroms.smiles
</pre> the result is: <pre>
-0.37
-0.2
-0.01
-0.39
-0.26
-0.15
-0.63
-0.47
-0.35
-0.32
-0.41
-0.33
-0.27
-0.37
</pre>

			<p></p>
		</li>
		<li><a class="anchor" id="friedelex"></a>A similar expression to
			the <a href="#friedel-exclude">exclude rule</a> of the <a
			href="#friedel">Friedel-Crafts acylation</a> reaction example: <pre>
match("[#15][H]") || 
(max(pka(filter("match('[O,S;H1]')"), "acidic")) > 14.5)  ||
(max(pka(filter("match('[#7:1][H]', 1)"), "basic")) > 0) 
</pre> This condition tests whether the molecule contains a phosphorus with an
			attached hydrogen, or the maximum acidic p<i>K</i><sub>a</sub> taken
			on an <code>OH</code> or <code>SH</code> is greater than <code>14.5</code>,
			or the maximum basic p<i>K</i><sub>a</sub> taken on nitrogen atoms
			with attached hydrogen is positive.
			<p>
				Saying that that the maximum basic p<i>K</i><sub>a</sub> on certain
				atoms is positive is the same as saying that there should be an atom
				among these atoms with a positive p<i>K</i><sub>a</sub>, but the
				former is the way to describe this fact in chemical terms. Thus, the
				above consition is satisfied if any of the following is satisfied:
			</p>
			<ol>
				<li>the molecule contains a phosphorus with an attached
					hydrogen, or</li>
				<li>the molecule contains an <code>OH</code> or <code>SH</code>
					with acidic p<i>K</i><sub>a</sub> greater than <code>14.5</code>,
					or
				</li>
				<li>the molecule contains a nitrogen with positive basic p<i>K</i><sub>a</sub>
					with an attached hydrogen
				</li>
			</ol> Note, that in logical expressions we put simpler calculations to the
			front to increase efficiency: if the first simple matching rule <code>match("[#15][H]")</code>
			is passed then there is no need to evaluate the other two with more
			complicated filtering and p<i>K</i><sub>a</sub> calculation.
			<p>To test this condition on our input molecules, type:</p>
			<pre>
evaluate -e friedel-crafts-exclude.txt aroms.smiles
</pre> It turns out, that the following input molecules satisfy this <a
			href="#friedel-exclude">exclude rule</a>, that is, the <a
			href="#friedel">Friedel-Crafts acylation</a> will not be performed
			for these molecules:
			<p></p>
			<p></p>
			<table align="center" border="0" cellspacing="0" cellpadding="5">
				<caption>
					<small><b>molecules excluded from <a href="#friedel">Friedel-Crafts
								acylation</a></b></small>
				</caption>
				<tr>
					<td><img border="1" src="img/friedel-crafts-excluded.png"
						width="392" height="124" alt=""></td>
				</tr>
			</table>

			<p></p></li>
		<li><a class="anchor" id="chemrules"></a>Finally, test some
			well-known and easily expressible chemical conditions on our input
			molecules:
			<ol>
				<p></p>
				<li><i>Lipinski's rule of five</i>: <pre>
(mass() <= 500) && 
(logP() <= 5) && 
(donorCount() <= 5) && 
(acceptorCount() <= 10)
</pre> Test this by: <pre>
evaluate -e lipinski.txt aroms.smiles
</pre> It turns out that all of our input molecules satisfy Lipinski's rule.

					<p></p></li>
				<li><i>Lead-likeness</i>: <pre>
(mass() <= 450) &&
(logD("7.4") >= -4) && (logD("7.4") <= 4) &&
(ringCount() <= 4) &&
(rotatableBondCount() <= 10) &&
(donorCount() <= 5) &&
(acceptorCount() <= 8)
</pre> Test this by: <pre>
evaluate -e lead-likeness.txt aroms.smiles
</pre> There is one molecule that fails to satisfy this rule:
					<p>
						<a class="anchor" id="aroms7"></a>
					</p>
					<p></p>
					<table align="center" border="0" cellspacing="0" cellpadding="5">
						<caption>
							<small><b><code>c1ccc2cc3ccccc3cc2c1</code></b></small>
						</caption>
						<tr>
							<td><img border="0" src="img/aroms7.png" width="220"
								height="124" alt=""></td>
						</tr>
					</table>
					<p>
						The reason is that its log<i>D</i> at
						<code>pH=7.4</code>
						is too big:
					</p>
					<pre>
evaluate -e "logD('7.4')" "c1ccc2cc3ccccc3cc2c1"
4.05
</pre>
					<p></p></li>
				<li><a class="anchor" id="bioavailability"></a><i>Bioavailability</i>:
					<pre>
(mass() <= 500) +
(logP() <= 5) +
(donorCount() <= 5) +
(acceptorCount() <= 10) +
(rotatableBondCount() <= 10) +
(PSA() <= 200) +
(fusedAromaticRingCount() <= 5) >= 6
</pre> Note, that summing up the <code>7</code> subresults above means to
					count how many of them are satisfied. The requirement that this sum
					should be at least <code>6</code> means that we do not rewuire all
					of the subconditions to be satisfy but instead we allow at most one
					of them to fail.
					<p>Test this by:</p>
					<pre>
evaluate -e bioavailability.txt aroms.smiles
</pre> It turns out that all of our input molecules satisfy this
					bioavailability rule.

					<p></p></li>
				<li><i>Ghose filter</i>: <pre>
(mass() >= 160) && (mass() <= 480) &&
(atomCount() >= 20) && (atomCount() <= 70) &&
(logP() >= -0.4) && (logP() <= 5.6) &&
(refractivity() >= 40) && (refractivity() <= 130)
</pre>
					<p>Test this by:</p>
					<pre>
evaluate -e ghose-filter.txt aroms.smiles
</pre> It turns out that only our <a href="#aroms7">previous molecule
						failing lead-likeness</a> passes this Ghose filter.

					<p></p></li>
				<li><i>Scaffold hopping</i>: <pre>
refmol = "c1ccccc1";
dissimilarity("ChemicalFingerprint", refmol) - 
dissimilarity("PharmacophoreFingerprint", refmol) > 0.6
</pre> Note, that molecule constants can be defined by a molecule file path or
					a SMILES string. Multiple expressions are separated by ';'
					characters, whitespace characters can be added freely for
					readability, since they are not considered by the evaluation
					process.
					<p>This condition tests whether the chemical and the
						pharmacophore dissimilarities between benzene and the input
						molecule are sufficiently far from each other, that is, the
						molecules should not be reasonably similar in pharmacophoric
						features but distant in chemical structure.</p>
					<p>Test this by:</p>
					<pre>
evaluate -e scaffold-hopping.txt aroms.smiles
</pre> It turns out that none of our input molecules satisfies this rule.</li>
			</ol>

			<p>
				Note, that the default output is a
				<code>0-1</code>
				list representing
				<code>true-false</code>
				values for each input molecule. You can use the
				<code>-x, --extract &lt;format&gt;</code>
				option to output precisely those input molecules that satisfy the
				condition. For example:
			</p>
			<pre>
evaluate -e ghose-filter.txt -x smiles aroms.smiles
</pre> will give the result: <pre>
c1ccc2cc3ccccc3cc2c1
</pre></li>
	</ul>

	<center>
		<div class="lenia">&nbsp;</div>
	</center>

	<h2>
		<a class="anchor" id="reaction_examples"></a>Reaction rule examples
	</h2>

	<p>In this section we show two sample reactions:</p>
	<ol>
		<li>Friedel-Crafts acylation</li>
		<li>Baeyer-Villiger ketone oxidation</li>
	</ol>
	<p>
		You can also find these reactions with some sample reactants in the <a
			href="http://www.chemaxon.com/jchem/examples/reactor/jsp/index.jsp"
			target="_blank">Reactor JSP example</a>.
	</p>
	<p>
		We demonstrate the use of <a
			href="http://www.chemaxon.com/jchem/doc/user/reactor_cline.html#rules">reaction
			rules</a>:
	</p>
	<ul>
		<li><a
			href="http://www.chemaxon.com/jchem/doc/user/reactor_cline.html#reactivity">reactivity
				rules</a> describe the chemical conditions of the reaction, while</li>
		<li><a
			href="http://www.chemaxon.com/jchem/doc/user/reactor_cline.html#selectivity">selectivity
				rules</a> select the main products and sort them by importance /
			occurrence in case of multiple possibilities, finally</li>
		<li><a
			href="http://www.chemaxon.com/jchem/doc/user/reactor_cline.html#exclude">exclude
				rules</a> are used to exclude products that we do not want to produce
			even if they may be chemically feasible (e.g. because they are not
			stable or the corresponding reactants are likely to produce
			side-reactions)</li>
	</ul>
	These chemical expressions formulating these rules access reaction data
	through a
	<a href="../../help/chemicalterms/ChemicalTerms.html#reactioncontext">reaction
		context</a>. Here are some examples for using this context:
	<ul>
		<li><code>reactant(0)</code>: the first reactant</li>
		<li><code>reactant(1)</code>: the second reactant</li>
		<li><code>product(0)</code>: the first product</li>
		<li><code>product(1)</code>: the second product</li>
		<li><code>ratom(1)</code>: the reactant atom matching map <code>1</code>
			in the reaction equation</li>
		<li><code>ratom(3)</code>: the reactant atom matching map <code>3</code>
			in the reaction equation</li>
		<li><code>patom(1)</code>: the product atom matching map <code>1</code>
			in the reaction equation</li>
		<li><code>patom(2)</code>: the product atom matching map <code>2</code>
			in the reaction equation</li>
	</ul>
	<p>
		You should map your reactions according to <a
			href="http://www.chemaxon.com/jchem/doc/user/reactor_cline.html#mapping">ChemAxon's
			reaction mapping style</a> to access reactant and product atoms by map
		matching. You can also use
		<code>Edit/Add/Atom Maps</code>
		in MarvinSketch to use automatical mapping, but always check the
		result, since this is an experimental feature.
	</p>

	<center>
		<div class="lenia">&nbsp;</div>
	</center>

	<p>
		<a class="anchor" id="friedel"></a>Our first example is <a
			href="Friedel-Crafts_acylation.mrv.txt">Friedel-Crafts acylation</a>:
		<!--nincs meg a file-->
	</p>
	<p></p>
	<p></p>
	<table align="center" border="0" cellspacing="0" cellpadding="5">
		<caption>
			<small><b><a href="Friedel-Crafts_acylation.mrv.txt">Friedel-Crafts_acylation.mrv</a></b></small>
		</caption>
		<tr>
			<td><img border="0" src="img/Friedel-Crafts_acylation.png"
				width="610" height="171" alt=""></td>
		</tr>
	</table>
	<p>The reaction has the following rules:</p>
	<ul>
		<li><a
			href="http://www.chemaxon.com/jchem/doc/user/reactor_cline.html#reactivity">reactivity</a>:
			<pre>
charge(ratom(1), "aromaticsystem") <= -0.2
</pre> meaning that the aromatic system should be at least as activated as
			dihalobenzenes.
			<p></p></li>
		<li><a
			href="http://www.chemaxon.com/jchem/doc/user/reactor_cline.html#selectivity">selectivity</a>:
			<pre>
-energyE(ratom(1))
</pre> this is a specific directional rule saying that the electrophilic
			substitution takes place on the aromatic carbon atom with the lowest
			localization energy having an attached electrophile in the transition
			state.
			<p></p></li>
		<li><a
			href="http://www.chemaxon.com/jchem/doc/user/reactor_cline.html#tolerance">selectivity
				tolerance</a>: <pre>
0.02
</pre> by this setting we change the default tolerance <code>0.0001</code> to
			accept other aromatic carbons having a similar localization energy
			with maximum difference <code>0.02</code> from the lowest value.
			Results will be sorted by this localization energy in ascending
			order, taking lowest first.
			<p></p></li>
		<li><a class="anchor" id="friedel-exclude"></a><a
			href="http://www.chemaxon.com/jchem/doc/user/reactor_cline.html#exclude">exclude</a>:
			<pre>
match(ratom(2), "[C:1]C=C", 1) ||
match(reactant(0), "[O,S]C=[O,S]") ||
match(reactant(0), "P[H]") || 
(max(pka(reactant(0), filter(reactant(0), "match('[O,S;H]')"), "acidic")) > 14.5) || 
(max(pka(reactant(0), filter(reactant(0), "match('[#7][H]')"), "basic")) > 0) 
</pre> The first reactant may not contain carboxylic acid group, or its thio
			analogue. Exclude acryloyc halides as acylating agent. Exclude PH
			compounds, and aromatic compounds containing such nucleophilic groups
			wich can be acylated among these conditions (OH, SH compounds with
			higher pKa than 14.5, and NH compounds with higher pKb than 0). This
			is a more complicated, somewhat heuristical rule. You may want to
			have a look at a <a href="#friedelex">similar condition</a> in the <a
			href="#basic_examples">basic examples</a> section referring to a <a
			href="../../help/chemicalterms/ChemicalTerms.html#molcontext">molecule
				context</a>. Note, that now our condition should explicitly refer to the
			input molecule as <code>reactant(0)</code>, meaning the first
			reactant, while in a molecule context the expression implicitly
			refers to the input molecule.
			<p>
				We exclude reactant pairs satisfying any of the following
				subexpressions (
				<code>||</code>
				means logical
				<code>OR</code>
				):
			</p>
			<ol>
				<li>the second reactant is an acryloic halide, testing this
					with an atom-matching condition on carbon atoms: <pre>
match(ratom(2), "[C:1]C=C", 1)
</pre>
					<p></p>
					<p>
						<a class="anchor" id="acryloic-halide"></a>
					</p>
					<table align="center" border="0" cellspacing="0" cellpadding="5">
						<caption>
							<small><b><a href="acryloic-halide.smiles">acryloic-halide.smiles</a></b></small>
						</caption>
						<tr>
							<td><img border="0" src="img/acryloic-halide.png"
								width="261" height="160" alt=""></td>
						</tr>
					</table>
					<p></p>
				</li>
				<li>the first reactant contains a phosphorus with an attached
					hydrogen: <pre>
match(reactant(0), "P[H]")
</pre>
				</li>
				<li>the first reactant contains an <code>OH</code> or <code>SH</code>
					with acidic p<i>K</i><sub>a</sub> greater than <code>14.5</code>: <pre>
max(pka(reactant(0), filter(reactant(0), "match('[O,S;H]')"), "acidic")) > 14.5
</pre>
				</li>
				<li>the first reactant contains a nitrogen with positive basic
					p<i>K</i><sub>a</sub> with an attached hydrogen: <pre>
max(pka(reactant(0), filter(reactant(0), "match('[#7][H]')"), "basic")) > 0
</pre>
				</li>
			</ol> Note, that we put simpler conditions first to increase efficiency.
			In the last two subexpressions, we use the <a
			href="../../help/chemicalterms/EvaluatorTables.html#filterdesc">filter
				function</a> with a <a
			href="../../help/chemicalterms/EvaluatorTables.html#matchdesc">match
				filtering condition</a> to extract the relevant atoms for the <a
			href="../../help/chemicalterms/EvaluatorTables.html#pkadesc">pka
				plugin</a> calculation. Finally, we take <a
			href="../../help/chemicalterms/EvaluatorTables.html#minmaxdesc">max</a>
			of these values to test whether any of them exceeds a certain limit.
		</li>
	</ul>
	<p>
		Refer to the <a href="../../help/chemicalterms/EvaluatorTables.html">Chemical
			Terms Reference Tables</a> for ChemAxon's Chemical Terms function /
		plugin calculation calculation syntax summary and explanation.
	</p>
	<p>
		Now it is time to process this reaction on some reactants! We will
		process the reaction on
		<code>14</code>
		reactant pairs.
	</p>
	<p>
		Our reactant file for the first reactant contains a set of aromatic
		molecules stored in <a href="aroms.smiles">aroms.smiles</a>:
	</p>
	<p></p>
	<table align="center" border="0" cellspacing="0" cellpadding="5">
		<caption>
			<small><b><a href="aroms.smiles">first reactants</a></b></small>
		</caption>
		<tr>
			<td><img border="0" src="img/aroms.png" width="517" height="495"
				alt=""></td>
		</tr>
	</table>
	<p>The set of the second reactants is very simple - we take the
		same acid-halide for each of the above aromatic molecules:</p>
	<p></p>
	<table align="center" border="0" cellspacing="0" cellpadding="5">
		<caption>
			<small><b><a name="acid-halide1"></a>acid-halide</b></small>
		</caption>
		<tr>
			<td><img border="0" src="img/acid-halide1.png" width="161"
				height="142" alt=""></td>
		</tr>
	</table>
	<p>Then we will test benzene with another acid-halide as well:</p>
	<p></p>
	<table align="center" border="0" cellspacing="0" cellpadding="5">
		<caption>
			<small><b><a name="acid-halide2"></a>another acid-halide</b></small>
		</caption>
		<tr>
			<td><img border="0" src="img/acid-halide2.png" width="218"
				height="152" alt=""></td>
		</tr>
	</table>
	<p>
		The second reactants are stored in <a href="acidhalides.smiles">acidhalides.smiles</a>
		with all but one molecule being identical to the first acid-halide
		above, while the last one being the second one.
	</p>
	<p>
		Now run <a href="http://www.chemaxon.com/jchem/doc/user/reactor.html">Reactor</a>
		to process the reaction:
	</p>
	<pre>
react -r Friedel-Crafts_acylation.mrv aroms.smiles acidhalides.smiles -t reaction -o Friedel-Crafts_results.smiles
</pre>
	<p>
		The result reactions are stored in <a
			href="Friedel-Crafts_results.smiles">Friedel-Crafts_results.smiles</a>.
	</p>
	<p>
		To analyze the results, examine the reactant pairs one-by-one. Observe
		that the only rule referring the second reactant is the exclude rule
		stating that the acid-halide carbon should not be the <a
			href="#acryloic-halide">acryloic-halide</a> mapped carbon. It follows
		that the our <a href="#acid-halide1">first acid-halide</a> is not
		excluded but our <a href="#acid-halide2">second acid-halide</a>
		obviously satisfies this condition and therefore the last reactant
		pair with benzene paired with this second acid-halide is excluded from
		the result. Now in the analyzation below, we examine the first
		reactant.
	</p>
	<p>You can check the reactivity and selectivity rules by:</p>
	<pre>
evaluate -e "charge('aromaticsystem')" r1.smiles
evaluate -e "energyE()" r1.smiles
</pre>
	where
	<code>r1.smiles</code>
	is a first reactant in SMILES form. These commands will list the
	evaluation results for each atom, seperated by ';' characters.
	<ol>
		<p></p>
		<li>benzene satisfies the reactivity condition (sum of partial pi
			charges in the aromatic system): <pre>
evaluate -e "charge('aromaticsystem')" "c1ccccc1"
-0.37;-0.37;-0.37;-0.37;-0.37;-0.37

</pre> and does not satisfy the exclude condition, since it does not contain
			phosphorus or ionizable atoms (no p<i>K</i><sub>a</sub> values),
			therefore the reaction is processed and the result is:
			<p></p>
			<table align="center" border="0" cellspacing="0" cellpadding="5">
				<caption>
					<small><b>reaction with benzene</b></small>
				</caption>
				<tr>
					<td><img border="1" src="img/r1.png" width="632" height="321"
						alt=""></td>
				</tr>
			</table>
			<p>Observe that the selectivity rule does not play here since it
				evaluates to the same value because of molecule symmetry.</p>
			<p></p>
		</li>
		<li>Our second aromatic molecule will not react because it fails
			to satisfy the reactivity rule: <pre>
evaluate -p 3 -e "charge('aromaticsystem')" "CC(=O)c1ccccc1"
0;0;0;-0.199;-0.199;-0.199;-0.199;-0.199;-0.199</pre> Now we see that the
			condition is not satisfied (<code>-0.199 > -0.2</code>).
			<p></p>
		</li>
		<li>The third reactant will not react for the same reason: <pre>
evaluate -e "charge('aromaticsystem')" "O=N(=O)c1ccccc1"
0;0;0;-0.01;-0.01;-0.01;-0.01;-0.01;-0.01
</pre>
			<p></p></li>
		<li>Toluol - satisfies the reactivity rule: <pre>
evaluate -e "charge('aromaticsystem')" "Cc1ccccc1"
0;-0.39;-0.39;-0.39;-0.39;-0.39;-0.39
</pre> Toluol is obviously not excluded (for the same reason as benzene,
			above), therefore we should evaluate the selectivity rule to
			determine the main products:
			<p></p>
			<table align="center" border="0" cellspacing="0" cellpadding="5">
				<caption>
					<small><b>energyE values for toluol</b></small>
				</caption>
				<tr>
					<td><img border="0" src="img/toluol.png" width="317"
						height="370" alt=""></td>
				</tr>
			</table>
			<p>
				Since our selectivity rule says to take the minimal localization
				energy (note that the localization energy is multiplied by
				<code>-1</code>
				to reverse the result order, i.e., to take the minimum instead of
				maximum), the ortho position is the best, then the para position is
				also accepted because the corresponding value is within tolerance:
				<code>2.46 - 2.45 < 0.02</code>
				:

			</p>
			<p></p>
			<table align="center" border="0" cellspacing="0" cellpadding="5">
				<caption>
					<small><b>reaction results for toluol</b></small>
				</caption>
				<tr>
					<td><img border="0" src="img/r4.png" width="582" height="367"
						alt=""></td>
				</tr>
			</table>
			<p></p></li>
		<li>Bromobenzene - the same situation as with toluol:
			<p></p>
			<table align="center" border="0" cellspacing="0" cellpadding="5">
				<caption>
					<small><b>energyE values for bromobenzene</b></small>
				</caption>
				<tr>
					<td><img border="0" src="img/brom-benzene.png" width="317"
						height="365" alt=""></td>
				</tr>
			</table>
			<p>The ortho and para positions are accepted, with the ortho
				position being the main result:</p>
			<p></p>
			<table align="center" border="0" cellspacing="0" cellpadding="5">
				<caption>
					<small><b>reaction results for bromobenzene</b></small>
				</caption>
				<tr>
					<td><img border="0" src="img/r5.png" width="600" height="381"
						alt=""></td>
				</tr>
			</table>
			<p></p>
		</li>
		<li>Anthracene - the reactivity rule is satisfied: <pre>
evaluate -e "charge('aromaticsystem')" "c1ccc2cc3ccccc3cc2c1"
-0.63;-0.63;-0.63;-0.63;-0.63;-0.63;-0.63;-0.63;-0.63;-0.63;-0.63;-0.63;-0.63;-0.63
</pre> Antracen is not excluded for the same reasons as toluol and benzene and
			the selectivity rule now determines a single position:
			<p></p>
			<table align="center" border="0" cellspacing="0" cellpadding="5">
				<caption>
					<small><b>energyE values for anthracene</b></small>
				</caption>
				<tr>
					<td><img border="0" src="img/antracen.png" width="495"
						height="421" alt=""></td>
				</tr>
			</table>
			<p>The reaction result is shown below:</p>
			<p></p>
			<table align="center" border="0" cellspacing="0" cellpadding="5">
				<caption>
					<small><b>reaction result for anthracene</b></small>
				</caption>
				<tr>
					<td><img border="0" src="img/r7.png" width="677" height="184"
						alt=""></td>
				</tr>
			</table>
			<p></p></li>
		<li>Indole - the reactivity rule is satisfied: <pre>
evaluate -e "charge('aromaticsystem')" "c1ccc2[nH]ccc2c1"
-0.55;-0.55;-0.55;-0.55;-0.55;-0.55;-0.55;-0.55;-0.55
</pre> Indole is not excluded because there is no basic p<i>K</i><sub>a</sub>
			on its nitrogen atom:
			<p></p>
			<table align="center" border="0" cellspacing="0" cellpadding="5">
				<caption>
					<small><b>p<i>K</i><sub>a</sub> values for indole
					</b></small>
				</caption>
				<tr>
					<td><img border="0" src="img/indol1.png" width="250"
						height="179" alt=""></td>
				</tr>
			</table>
			<p>The selectivity rule selects a single position:</p>
			<p></p>
			<table align="center" border="0" cellspacing="0" cellpadding="5">
				<caption>
					<small><b>energyE values for indole</b></small>
				</caption>
				<tr>
					<td><img border="0" src="img/indol2.png" width="388"
						height="351" alt=""></td>
				</tr>
			</table>
			<p>The reaction result is shown below:</p>
			<p></p>
			<table align="center" border="0" cellspacing="0" cellpadding="5"
				id="grid">
				<caption>
					<small><b>reaction result for indole</b></small>
				</caption>
				<tr>
					<td><img border="0" src="img/r8.png" width="677" height="187"
						alt=""></td>
				</tr>
			</table>
			<p></p></li>
		<li>Phenol - the reactivity rule is satisfied: <pre>
evaluate -e "charge('aromaticsystem')" "Oc1ccccc1"
0;-0.35;-0.35;-0.35;-0.35;-0.35;-0.35
</pre> Phenol is not excluded, because the acidic p<i>K</i><sub>a</sub> on its
			OH is not greater than the specified <code>14.5</code> limit:
			<p></p>
			<table align="center" border="0" cellspacing="0" cellpadding="5">
				<caption>
					<small><b>p<i>K</i><sub>a</sub> values for phenol
					</b></small>
				</caption>
				<tr>
					<td><img border="0" src="img/phenol1.png" width="161"
						height="216" alt=""></td>
				</tr>
			</table>
			<p>The selectivity rule selects the ortho and the para positions:
			</p>
			<p></p>
			<table align="center" border="0" cellspacing="0" cellpadding="5">
				<caption>
					<small><b>energyE values for phenol</b></small>
				</caption>
				<tr>
					<td><img border="0" src="img/phenol2.png" width="343"
						height="344" alt=""></td>
				</tr>
			</table>
			<p>The resulting reactions are shown below:</p>
			<p></p>
			<table align="center" border="0" cellspacing="0" cellpadding="5"
				id="grid">
				<caption>
					<small><b>reaction results for phenol</b></small>
				</caption>
				<tr>
					<td><img border="0" src="img/r9.png" width="579" height="182"
						alt=""></td>
				</tr>
			</table>
			<p></p></li>
		<li>The next three molecules satisfy the exclude condition
			regarding the conditions on the p<i>K</i><sub>a</sub> values
			(positive basic p<i>K</i><sub>a</sub> on a nitrogen having an
			attached H or acidic p<i>K</i><sub>a</sub> greater than <code>14.5</code>
			on an <code>OH</code> or <code>SH</code>):
			<p></p>
			<table align="center" border="0" cellspacing="0" cellpadding="5"
				id="grid">
				<caption>
					<small><b>p<i>K</i><sub>a</sub> values satisfying the
							exclude rule
					</b></small>
				</caption>
				<tr>
					<td><img border="0" src="img/exclude1.png" width="250"
						height="275" alt=""></td>
					<td><img border="0" src="img/exclude2.png" width="153"
						height="238" alt=""></td>
					<td><img border="0" src="img/exclude3.png" width="238"
						height="257" alt=""></td>
				</tr>
			</table>
			<p></p>
		</li>
		<li>Phenylacetamide - has negative p<i>K</i><sub>a</sub> on its
			nitrogen, therefore it is not excluded:
			<p></p>
			<table align="center" border="0" cellspacing="0" cellpadding="5">
				<caption>
					<small><b>p<i>K</i><sub>a</sub> values for
							phenylacetamide
					</b></small>
				</caption>
				<tr>
					<td><img border="0" src="img/phenyl-acetamide1.png"
						width="246" height="293" alt=""></td>
				</tr>
			</table>
			<p>Phenylacetamide satisfies the reactivity rule:</p>
			<pre>
evaluate -e "charge('aromaticsystem')" "CC(=O)Nc1ccccc1"
0;0;0;0;-0.27;-0.27;-0.27;-0.27;-0.27;-0.27
</pre> The selectivity rule selects a single position (ortho):
			<p></p>
			<table align="center" border="0" cellspacing="0" cellpadding="5">
				<caption>
					<small><b>energyE values for phenylacetamide</b></small>
				</caption>
				<tr>
					<td><img border="0" src="img/phenyl-acetamide2.png"
						width="383" height="398" alt=""></td>
				</tr>
			</table>
			<p>The resulting reaction is shown below:</p>
			<p></p>
			<table align="center" border="0" cellspacing="0" cellpadding="5">
				<caption>
					<small><b>reaction result for phenylacetamide</b></small>
				</caption>
				<tr>
					<td><img border="0" src="img/r13.png" width="588" height="182"
						alt=""></td>
				</tr>
			</table>
		</li>
	</ol>
	<p>
		You can also run this reaction in the <a
			href="http://www.chemaxon.com/jchem/examples/reactor/jsp/index.jsp"
			target="_blank">Reactor JSP example</a>. This is in ChemAxon's
		Reaction Library, you can try to alter or ignore the reaction rules,
		set different reactants from file or draw your favorite test
		molecules. You can also save / load the altered reaction. You are more
		than welcome to post your reaction to the <a
			href="http://www.chemaxon.com/forum/forum8.html" target="_blank">ChemAxon
			forum</a>.
	</p>


	<center>
		<div class="lenia">&nbsp;</div>
	</center>

	<p>
		<a class="anchor" id="baeyer"></a>Our second example is <a
			href="Baeyer-Villiger_ketone_oxidation.mrv.txt">Baeyer-Villiger
			ketone oxidation</a>:
	</p>
	<p></p>
	<p></p>
	<table align="center" border="0" cellspacing="0" cellpadding="5">
		<caption>
			<small><b><a
					href="Baeyer-Villiger_ketone_oxidation.mrv.txt">Baeyer-Villiger_ketone_oxidation.mrv</a></b></small>
		</caption>
		<tr>
			<td><img border="0"
				src="img/Baeyer-Villiger_ketone_oxidation.png" width="674"
				height="149" alt=""></td>
		</tr>
	</table>
	<p>The reaction has the following rules:</p>
	<ul>
		<li><a
			href="http://www.chemaxon.com/jchem/doc/user/reactor_cline.html#reactivity">reactivity</a>:
			<pre>
!match(ratom(1), "O=[C:1][C]([H])C=O", 1)
</pre> meaning that &beta;-diketones able to enolize do not react; we test
			this by an atom mathching condition: the ketone carbon matching map <code>1</code>
			in the reaction equation should not match the carbon with map <code>1</code>
			in &beta;-diketones:
			<p></p>
			<table align="center" border="0" cellspacing="0" cellpadding="5">
				<caption>
					<small><b><a href="beta-diketone.smiles">beta-diketone.smiles</a></b></small>
				</caption>
				<tr>
					<td><img border="0" src="img/beta-diketone.png" width="271"
						height="184" alt=""></td>
				</tr>
			</table>
			<p></p></li>
		<li><a
			href="http://www.chemaxon.com/jchem/doc/user/reactor_cline.html#selectivity">selectivity</a>:
			<pre>
charge(ratom(2), "sigma")
</pre> meaning that the oxygen goes between the carbonyl carbon and its
			neighbour with the biggest &sigma; charge.
			<p></p></li>
		<li><a
			href="http://www.chemaxon.com/jchem/doc/user/reactor_cline.html#tolerance">selectivity
				tolerance</a>: we do not set the tolerance, therefore the default
			tolerance <code>0.0001</code> will be applied, which practically
			means that only the main product is accepted.
			<p></p></li>
		<li><a class="anchor" id="baeyer-exclude"></a><a
			href="http://www.chemaxon.com/jchem/doc/user/reactor_cline.html#exclude">exclude</a>:
			<pre>
match(reactant(0), "[#5,#7,#8,#14,#15,#16][H]") || 
match(reactant(0), "[n,s]") || 
match(reactant(0), "[#6]S[#6,#16]") || 
match(reactant(0), "[#6]S([#6])=[N,O]") || 
match(reactant(0), "[H]C=O")
</pre> We exclude reagents containing <code>BH, NH, OH, SiH, PH, SH</code>
			groups or aromatic <code>N, S</code> or sulfide, disulfide, sulfoxyde
			or sulfimide groups and we also exclude aldehydes producing
			carboxylic acids with these reagents.</li>
	</ul>
	<p>
		Refer to the <a href="../../help/chemicalterms/EvaluatorTables.html">Chemical
			Terms Reference Tables</a> for ChemAxon's Chemical Terms function /
		plugin calculation syntax summary and explanation.
	</p>
	<p>
		Our reactant file is <a href="ketones.smiles">ketones.smiles</a>:
	</p>
	<p></p>
	<table align="center" border="0" cellspacing="0" cellpadding="5">
		<caption>
			<small><b><a href="ketones.smiles">ketones</a></b></small>
		</caption>
		<tr>
			<td><img border="0" src="img/ketones.png" width="559"
				height="342" alt=""></td>
		</tr>
	</table>
	<p>
		Now run <a href="http://www.chemaxon.com/jchem/doc/user/reactor.html">Reactor</a>
		to process the reaction:
	</p>
	<pre>
react -r Baeyer-Villiger_ketone_oxidation.mrv ketones.smiles -t reaction -o Baeyer-Villiger_results.smiles
</pre>
	<p>
		The result reactions are stored in <a
			href="Baeyer-Villiger_results.smiles">Baeyer-Villiger_results.smiles</a>:
	</p>
	<p>
		<a class="anchor" id="Baeyer-Villiger_results"></a>
	</p>
	<table align="center" border="0" cellspacing="0" cellpadding="5">
		<caption>
			<small><b><a href="Baeyer-Villiger_results.smiles">Baeyer-Villiger
						results</a></b></small>
		</caption>
		<tr>
			<td><img border="0" src="img/Baeyer-Villiger_results.png"
				width="601" height="851" alt=""></td>
		</tr>
	</table>
	<p>
		Observe, that our 5th ketone does not react because it is a
		&beta;-diketone and hence does not satisfy our reactivity criteria.
		The 6th ketone is an &alpha;-diketone matching
		<code>[H]C=O</code>
		in our <a href="#baeyer-exclude">exclude rule</a>, therefore that will
		not react either. The specific chemical reason is that these ketones
		produce anhydrides instead of oxidation. All other ketones from our
		input set react (satisfy our reactivity rule and are not excluded by
		our exclude rule), therefore our selectivity rule will determine the
		main product. We show the atomic sigma-charges below, look at the
		charge values on atoms matching reaction map
		<code>2</code>
		, marked with
		<code>2</code>
		in the following sample:
	</p>
	<p></p>
	<table align="center" border="0" cellspacing="0" cellpadding="5"
		id="grid">
		<caption>
			<small><b>atoms to be checked for sigma-charge</b></small>
		</caption>
		<tr>
			<td><img border="0" src="img/sample.png" width="158"
				height="140" alt=""></td>
		</tr>
	</table>
	<p>
		Now look at these sigma-charge values and check that the bigger value
		is selected in <a href="#Baeyer-Villiger_results">our results</a>
		above:
	</p>
	<p></p>
	<table align="center" border="0" cellspacing="0" cellpadding="5"
		id="grid">
		<caption>
			<small><b>sigma-charge values in ketones</b></small>
		</caption>
		<tr>
			<td><img border="0" src="img/sigma-charges.png" width="478"
				height="652" alt=""></td>
		</tr>
	</table>
	<p>
		You can also run this reaction in the <a
			href="http://www.chemaxon.com/jchem/examples/reactor/jsp/index.jsp"
			target="_blank">Reactor JSP example</a>. This is in ChemAxon's
		Reaction Library, you can try to alter or ignore the reaction rules,
		set different reactants from file or draw your favorite test
		molecules. You can also save / load the altered reaction. You are more
		than welcome to post your reaction to the <a
			href="http://www.chemaxon.com/forum/forum8.html" target="_blank">ChemAxon
			forum</a>.
	</p>

	<center>
		<div class="lenia">&nbsp;</div>
	</center>

	<h2>
		<a class="anchor" id="search_examples"></a>Search filtering examples
	</h2>

	<p>
		In this section we show some examples for <a
			href="http://www.chemaxon.com/jchem/doc/user/Jcsearch.html#expression">search
			filters</a>. These expressions filter targets, queries and/or search
		hits: the substructure search is performed only for target-query pairs
		satisfying the filtering condition, furthermore, search hits are
		filtered by the expression.
	</p>
	<p>
		Search data (target, query, search hits) is accessed through a <a
			href="../../help/chemicalterms/ChemicalTerms.html#searchcontext">search
			context</a>.
		<!--mi�rt nem j�?-->
		Here are some examples for using this context:
	</p>
	<ul>
		<li><code>target()</code> or <code>mol()</code>: the target
			molecule, this is usually omitted since the default input molecule is
			the target</li>
		<li><code>query()</code>: the query molecule</li>
		<li><code>m(1)</code>: query atom index of query atom with map <code>1</code>
		</li>
		<li><code>m(2)</code>: query atom index of query atom with map <code>2</code>
		</li>
		<li><code>h(0)</code> or <code>hit(0)</code>: target atom index
			matching query atom with atom index <code>0</code> (0-based indexing)
		</li>
		<li><code>h(3)</code> or <code>hit(3)</code>: target atom index
			matching query atom with atom index <code>3</code> (0-based indexing)
		</li>
		<li><code>hm(2)</code>: target atom index matching query atom
			with map <code>2</code></li>
		<li><code>hm(4)</code>: target atom index matching query atom
			with map <code>4</code></li>
	</ul>

	<p>
		In the examples below, the target molecules are stored in <a
			href="targets.smiles">targets.smiles</a>:
	</p>
	<p></p>
	<table align="center" border="0" cellspacing="0" cellpadding="5">
		<caption>
			<small><b><a href="targets.smiles">targets.smiles</a></b></small>
		</caption>
		<tr>
			<td><img border="0" src="img/targets.png" width="552"
				height="538" alt=""></td>
		</tr>
	</table>

	<p>
		Queries are stored in <a href="queries.smarts">queries.smarts</a>:
	</p>
	<p></p>
	<table align="center" border="0" cellspacing="0" cellpadding="5">
		<caption>
			<small><b><a href="queries.smarts">queries.smarts</a></b></small>
		</caption>
		<tr>
			<td><img border="0" src="img/queries.png" width="281"
				height="101" alt=""></td>
		</tr>
	</table>

	<p>
		In the following examples we use the <a
			href="http://www.chemaxon.com/jchem/doc/user/Jcsearch.html"><code>jcsearch</code></a>
		command line tool to perform substructure search with filtering.
	</p>


	<ol>
		<li>Filtering targets:
			<ul>
				<li>Output targets with carboxylic group(s) having molecular
					mass bigger than <code>170</code>: <pre>
jcsearch targets.smiles -q "[#8:1]C=O" -e "mass() > 170"
OC(=O)Cc1cccc(c1)C(O)=O
Nc1cc(CC(O)=O)cc(N)c1N
NC(C(O)=O)c1ccc2c(O)c3cccc(N)c3cc2c1
</pre> Note, that our 3rd target molecule also contains a carboxylic group but
					is not present in the output since it has molecular mass <code>151.16</code>.
					You can check molecular masses by: <pre>
evaluate -e "mass()" targets.smiles
180.16
181.19
151.16
282.29
209.24
178.23
</pre>
				</li>
				<li>Add another restriction on the ring count, and you will
					filter out the 4th target too: <pre>
jcsearch targets.smiles -q "[#8:1]C=O" -e "mass() > 170 && ringCount() == 1"
OC(=O)Cc1cccc(c1)C(O)=O
Nc1cc(CC(O)=O)cc(N)c1N
</pre>
				</li>
				<li>You can also filter by some well-known <a href="#chemrules">chemical
						rules</a>, such as <i>Lipinski's rule of five</i>, <i>Lead-likeness</i>,
					<i>Bioavailability</i> or the <i>Ghose filter</i>, and any <code>boolean</code>
					condition shown in the <a href="#basic_examples">basic examples</a>
					section above, since here the input molecule will automatically
					refer to the target. For example, test the Ghose filter with the
					carboxylic group query: <pre>
jcsearch targets.smiles -q "[#8:1]C=O" -e ghose-filter.txt 
OC(=O)Cc1cccc(c1)C(O)=O
</pre> Only the first target is accepted because only our first <code>4</code>
					targets contain a carboxylic group and only the first of these
					satisfied the <a href="ghose-filter.txt">Ghose filter</a>: <pre>
evaluate -e ghose-filter.txt targets.smiles
1
0
0
0
1
1
</pre>
				</li>
			</ul>

		</li>
		<li>Filtering queries:
			<ul>
				<li>First set a molecular mass requirement on the query: <pre>
jcsearch targets.smiles -q "[#8:1]C=O" -e "mass(query()) > 20"
OC(=O)Cc1cccc(c1)C(O)=O
Nc1cc(CC(O)=O)cc(N)c1N
NC(C(O)=O)c1ccccc1
NC(C(O)=O)c1ccc2c(O)c3cccc(N)c3cc2c1
</pre> All target molecules containing carboxylic group(s) are returned, since
					our query satisfies has molecular mass <code>44.01</code>: <pre>
evaluate -e "mass()" "[#8:1]C=O"
44.01
</pre> However, when running this with our nitrogen query then there is no
					output, although we have <code>4</code> target molecules containing
					nitrogen: <pre>
jcsearch targets.smiles -q "[#7:1]" -e "mass(query()) > 20"
</pre> because nitrogen has molecular mass <code>14.01</code>: <pre>
evaluate -e "mass()" "[#7:1]"
14.01
</pre>
				</li>
				<li>Next, set a condition on a query atom. In this example we
					require that the query atom with map <code>1</code> should have
					partial charge greater than <code>-0.05</code>. This time we have
					empty result set for the carboxylic group but have the <code>4</code>
					search hits for the nitrogen: <pre>
jcsearch targets.smiles -q "[#8:1]C=O" -e "charge(query(), m(1)) > -0.05"
jcsearch targets.smiles -q "[#7:1]" -e "charge(query(), m(1)) > -0.05"
Nc1cc(CC(O)=O)cc(N)c1N
NC(C(O)=O)c1ccccc1
NC(C(O)=O)c1ccc2c(O)c3cccc(N)c3cc2c1
Nc1cccc2c(O)c3ccccc3cc12
</pre> since the nitrogen has zero charge while the partial charge on the
					carboxylic OH is <code>-0.1</code>. Note, that we refer to the
					query molecule as <code>query()</code> and its mapped atom with
					atom map <code>1</code> as <code>m(1)</code>. You can also refer to
					query aotms by atom indices but in most cases it is more difficult
					to determine. However, since nitorgen has only one atom, you can
					safely write: <pre>
jcsearch targets.smiles -q "[#7]" -e "charge(query(), 0) > -0.1"
Nc1cc(CC(O)=O)cc(N)c1N
NC(C(O)=O)c1ccccc1
NC(C(O)=O)c1ccc2c(O)c3cccc(N)c3cc2c1
Nc1cccc2c(O)c3ccccc3cc12
</pre> and you can also omit the atom map in the query.
				</li>
			</ul>

			<p></p>
		</li>
		<li>Filtering search hits:
			<p>
				In these examples we filter search hits by setting conditions on p<i>K</i><sub>a</sub>
				values calculated on target atoms matching carboxylic oxygens or
				nitrogens. In order that you could check the results easily, we show
				the p<i>K</i><sub>a</sub> values together with atom indices for the
				target molecules:
			</p>
			<p>
				<a class="anchor" id="pka"></a>
			</p>
			<table align="center" border="0" cellspacing="0" cellpadding="5">
				<caption>
					<small><b>p<i>K</i><sub>a</sub> values in <a
							href="targets.smiles">targets</a></b></small>
				</caption>
				<tr>
					<td><img border="0" src="img/pka.png" width="754" height="842"
						alt=""></td>
				</tr>
			</table>


			<ul>
				<li>First look at all carboxylic group hits and all nitrogen
					hits: <pre>
jcsearch targets.smiles -q "[#8:1]C=O" --allHits
    Query 0 matches:
        Match 0:[    1,   2,   3 ]
        Match 1:[   12,  11,  13 ]
OC(=O)Cc1cccc(c1)C(O)=O
    Query 0 matches:
        Match 0:[    7,   6,   8 ]
Nc1cc(CC(O)=O)cc(N)c1N
    Query 0 matches:
        Match 0:[    4,   3,   5 ]
NC(C(O)=O)c1ccccc1
    Query 0 matches:
        Match 0:[    4,   3,   5 ]
NC(C(O)=O)c1ccc2c(O)c3cccc(N)c3cc2c1

jcsearch targets.smiles -q "[#7:1]" --allHits
    Query 0 matches:
        Match 0:[    1 ]
        Match 1:[   11 ]
        Match 2:[   13 ]
Nc1cc(CC(O)=O)cc(N)c1N
    Query 0 matches:
        Match 0:[    1 ]
NC(C(O)=O)c1ccccc1
    Query 0 matches:
        Match 0:[    1 ]
        Match 1:[   17 ]
NC(C(O)=O)c1ccc2c(O)c3cccc(N)c3cc2c1
    Query 0 matches:
        Match 0:[    1 ]
Nc1cccc2c(O)c3ccccc3cc12
</pre>

				</li>
				<li>Next, set filtering condition on the p<i>K</i><sub>a</sub>
					at target atom matching query atom with map <code>1</code>, which
					is either the carboxylic <code>OH</code> or the nitrogen depending
					on the query. Note, that we refer to this atom as <code>hm(1)</code>.
					<pre>
jcsearch targets.smiles -q "[#8:1]C=O" --allHits -e "pka(hm(1)) > 4"    
    Query 0 matches:
        Match 0:[   12,  11,  13 ]
OC(=O)Cc1cccc(c1)C(O)=O
    Query 0 matches:
        Match 0:[    7,   6,   8 ]
Nc1cc(CC(O)=O)cc(N)c1N

jcsearch targets.smiles -q "[#7:1]" --allHits -e "pka(hm(1)) > 4"
    Query 0 matches:
        Match 0:[   13 ]
Nc1cc(CC(O)=O)cc(N)c1N
    Query 0 matches:
        Match 0:[    1 ]
NC(C(O)=O)c1ccccc1
    Query 0 matches:
        Match 0:[    1 ]
NC(C(O)=O)c1ccc2c(O)c3cccc(N)c3cc2c1
</pre> Check these results by looking at the <a href="#pka">p<i>K</i><sub>a</sub>
						values
				</a>.

					<p></p></li>
				<li>Finally, combine hit filtering with a condition on the
					target molecule: <pre>
jcsearch targets.smiles -q "[#8:1]C=O" --allHits -e "mass() > 170 && ringCount() == 1 && pka(hm(1)) > 4"
    Query 0 matches:
        Match 0:[   12,  11,  13 ]
OC(=O)Cc1cccc(c1)C(O)=O
    Query 0 matches:
        Match 0:[    7,   6,   8 ]
Nc1cc(CC(O)=O)cc(N)c1N

jcsearch targets.smiles -q "[#7:1]" --allHits -e "mass() > 170 && ringCount() == 1 && pka(hm(1)) > 4"
    Query 0 matches:
        Match 0:[   13 ]
Nc1cc(CC(O)=O)cc(N)c1N
</pre> Note, that while both carboxylic hits are kept because these targets
					satisfy both conditions, while two nitrogen hits are filtered out,
					becuase one target fails to satisfy the mass condition, and the
					other one has <code>3</code> rings. Observe, that we put simpler
					conditions to the front for efficiency: if the mass condition fails
					then the others are not considered at all.
				</li>
			</ul>
		</li>
	</ol>

	<p>
		You can try and test filtering conditions at <a
			href="http://www.chemaxon.com/jchem/examples/db_search/index.jsp"
			target="_blank"> ChemAxon's database search JSP example</a>. Feel
		free to share your experience at the <a
			href="http://www.chemaxon.com/forum/forum8.html" target="_blank">ChemAxon
			forum</a>.
	</p>


	<center>
		<center>
			<div class="lenia">&nbsp;</div>
		</center>
		<font size="-2" face="helvetica"> Copyright &copy; 1999-2015 <a
			href="http://www.chemaxon.com">ChemAxon Ltd.</a>
			&nbsp;&nbsp;&nbsp;All rights reserved.
		</font>
	</center>

</BODY>
</HTML>
