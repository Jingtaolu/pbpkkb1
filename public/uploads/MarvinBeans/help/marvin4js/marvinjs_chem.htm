<!DOCTYPE HTML>
<html>
<!-- saved from url=(0029)http://www.helpandmanual.com/ -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta name="author" content="Dóra Barna, Eufrozina Hoffmann">
	<link rel ="stylesheet" type="text/css" href="../marvinmanuals.css" title="Style">
   <title>Chemical Features in Marvin JS</title>
   <!--meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="X-UA-Compatible" content="IE=edge" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <style type="text/css">
     body { margin: 0px; background: #FFFFFF; }
   </style>
<script type="text/javascript" src="helpman_topicinit.js"></script-->
<!-- Redirect browser to frame page if page is not in the content frame. -->
<!--script type="text/javascript"-->
<!--
if (location.search.lastIndexOf("toc=0")<=0) {
  if (parent.frames.length==0) { parent.location.href="index.html?chemical_features_in_marvin_fo.htm"; }
  else { parent.quicksync('a1.3'); }
}
//-->
<!--/script>
<script type="text/javascript" src="highlight.js"></script-->
</head>
<body>


<h1>Chemical Features in Marvin JS</h1>

<h2><a id="atomProperties" class="anchor"></a>Atom Properties</h2>
<p>You can add charge, mass number, and radical to an atom in Marvin JS; furthermore, you can define an alias for any atom as well. 
	All of these properties can be set in the <a href="marvinjs_basic.htm#atomproperties">Atom properties dialog</a>.
	<ul>
		<li>Charge: You can add charge to every atom type by using either the toolbar buttons, or the "+"/"-" keyboard buttons beside the <b>Atom properties</b> dialog. 
			Charges are taken into account by valence check, and the number of implicit hydrogens is adjusted when charges are added to an atom.</li>
		<li>Isotopes: Marvin JS allows setting any arbitrary number as mass number for an atom.</li>
		<li>Radical: Currently, Marvin JS supports only monovalent radicals. In order to set radical property for an atom, open the <b>Atom properties</b> dialog and select "monovalent" from the drop-down list 
			in the "Radical" field.</li>
	</ul>
	Marvin JS automatically calculates the lone pairs of every atom on the canvas. The visibility of the lone pairs is optional, can switched on/off with the help of "Show lone pairs" checkbox in the 
	<b><a href="marvinjs_basic.htm#structuredisplayoptions">View settings</a></b> dialog.</p>

<h2><a id="reaction" class="anchor"></a>Reactions</h2>
<p>Currently, you can draw reactions in Marvin JS using simple (straight) reaction arrows, or you can use resonance (two-headed) arrows to display the mesomeric structures of a compound.<br>
	The "+" signs between the reactant or product molecules have to be added manually in each case using the <a href="toolbars.htm#reactionOperator">Reaction Operator</a> 
	button on the <b>Tools</b> toolbar. Alternatively, if you select the reactant or the product side, and then press the <b>Reaction Operator</b> button, 
	the "+" signs will be added automatically between each reactant or product molecule. However, it works only if the selection does not contain other "+" signs or a reaction arrow.</p>
<p>If the structure on the canvas contains only a single step reaction, then this structure will be automatically exported as a "reaction file" by Marvin JS. 
	This means that in the exported file there will be separate blocks for reactants, products and agents making it possible to use the exported file in a reaction search. 
	In this case, only those file formats are available in the <b>Save</b> dialog which support reactions (MRV, RXN, SMILES, CXSMILES, SMARTS, CXSMARTS, CML, 
	RXN V3000, SDF, CSSDF, CDX, SKC). Please note that the conversion of the structure to a reaction file happens on server side and requires the reaction converter webservice to be available.<br>
	In the case of multistep reactions (or when the reaction converter webservice is not available), the structure will not be converted to a reaction file. 
	In this case, there will not be reactant/product/agent blocks in the exported files and the "+" signs and arrows of the reaction(s) will be exported as graphical objects.</p>

<h3><a id="mechanism" class="anchor"></a>Reaction Mechanisms</h3>
<p>Marvin JS supports the detailed display of recation mechanisms by using electron flow arrows (or mechanism arrows) to describe the formation and breaking of chemical bonds. 
	You can use single and double electron flow arrows for representing each elementary step in a complex mechanism. 
	<a href="electronflow.html">You can read a detalied description about using electron flow arrows in Marvin JS.</a></p>

<h2><a id="mapping" class="anchor"></a>Mapping Atoms</h2>
<p>Marvin JS provides the option to set map numbers to individual atoms. Unlike atom indices, map numbers remains constant during editing the molecule. 
	Mapping can be useful if you want to identify corresponding atoms in the reactant and product side of a reaction. 
	Map numbers can be added to each atom manually in the <a href="marvinjs_basic.htm#atomproperties">Atom properties</a> dialog.</p>	
	
<h2><a id="sGroup" class="anchor"></a>Substructure Groups (S-groups)</h2>
<p>S-groups or substructure groups represent an integral part of a chemical structure. Marvin JS can handle generic S-groups and predefined abbreviated groups (superatom S-groups). 
	Structures containing S-groups can be imported and exported either in MRV or in MDL Molfile format.</p>
	
<h3><a id="genericGroup" class="anchor"></a>Generic S-groups</h3>
<p>Generic S-groups usually represent whole molecules, <i>e.g.</i>, solvents. They are visualized between brackets, which will disappear if you remove the group status from the substructure either by using the 
	<b>Ungroup</b> option of the <b><a href="popups.htm#groupPopUp">Group pop-up menu</a></b> or by editing the molecule (changing/adding/deleting atoms or bonds, modifying atom properties...).</p>

<h3><a id="abbrevGroup" class="anchor"></a>Abbreviated groups (Superatom S-groups)</h3>
<p>An abbreviated group can be part of a larger molecule by connecting the group to other fragments through its attachment point. Currently, only a predefined list of abbreviated groups is available in Marvin JS. 
	Using the abbreviations of chemical functional groups and molecules enables us to create more compact structures. Alternatively, abbreviated groups can be displayed in their full, 
	expanded forms in favor of a more detailed description of the crucial parts of the molecule.</p>
<p>Marvin JS offers a wide selection of abbreviated groups belonging to several chemical compound families (carbohydrates, amino acids, <i>etc.</i>s). 
	These structures are available under the <b><a href="toolbars.htm#abbrevGroup">Abbreviated Groups</a></b> button of the <b>Tools</b> toolbar. 
	Selecting a group in the opening dialog, you can decide whether to use the group in its contracted or expanded form. For the latter option, tick the checkbox in the dialog window. 
	Pressing the "OK" button closes the dialog and puts the selected group on the tip of the cursor, from where you can place it on the canvas with a left-click.</p>
<p>An abbreviated group can be expanded, contracted, or ungrouped after it has been placed on the canvas. These options are available from the <b><a href="popups.htm#groupPopUp">Group pop-up menu</a></b><br>
	<ul>
		<li>Expanded groups are denoted by special feedback: grey background and brackets appear around the group if the cursor is over it 
			(the green "hover-over" feedback is still visible on the respective atom or bond), and the abbreviated name is also visible. The attachment points of the groups are circled in blue:<br>
			<img src="marvinjs_chem_files/abbrevgroup2.png"></li>
		<li>If an expanded group is "ungrouped", the feedback around it will disappear. The same action in case of a contracted group means that the group will be firstly expanded, and its feedback will disappear.</li>
		<li>Contracted groups can be manipulated as atoms; while expanded abbreviated groups can be handled as molecules or fragments: they can be rotated, dragged, merged, mirrored, deleted, and cleaned in 2D.</li>
		<li>Editing an expanded abbreviated group in any sense - <i>i.e.</i>, changing/deleting an atom or a bond, modifying the charge or mass number of atoms - 
			leads to the removal of the group status from the substructure.</li>
	</ul>
	
<h2><a id="clean" class="anchor"></a>Structure Cleaning</h2>

<h3><a id="clean2d" class="anchor"></a>2D cleaning</h3>
<p>2D cleaning of molecules can be performed using the <b><a href="toolbars.htm#clean">Clean</a></b> button of the <b>General</b> toolbar. 
	It calculates new 2D coordinates for the atoms on the canvas in order to get the same molecule in an evenly organized fashion.</p>
<p>Partial cleaning of a structure is possible, too. If you have selected fragments of molecules or certain elements of a multi-molecular structure, 2D cleaning affects only these selected objects.</p>
<p>The 2D cleaning feature is available only if the server connection is active, and the appropriate webservice is available, otherwise, the <b>Clean</b> button will not appear on the toolbar.</p>

<h3><a id="clean3d" class="anchor"></a>3D cleaning</h3>
<p>You can determine the 3D structure of your molecules ("clean them in 3D") by using the <b><a href="toolbars.htm#clean3d">Clean 3D</a></b> on the <b>General</b> toolbar.</p>
<p>The 3D cleaning feature is available only if the server connection is active, and the appropriate webservice is available, otherwise the <b>Clean 3D</b> button will not appear on the toolbar.</p>
	
<h2><a id="validation" class="anchor"></a>Structure Validation</h2>
<p>Marvin JS only highlights valence errors, but does not correct them, so you should make the necessary corrections manually. 
	In case of recognizing a valence error, Marvin JS highlights the particular atom with red background. 
	This highlight can be turned on and off on the <a href="marvinjs_basic.htm#structuredisplayoptions">View settings</a> dialog.</p>
	
<h2><a id="stereo" class="anchor"></a>Stereoisomerism</h2>
<p>Both optical isomerism and geometric isomers can be determined in Marvin JS. In order to assign the <b><i>R</i></b> or <b><i>S</i></b> label to a chiral center 
	and the <b><i>E</i></b> or <b><i>Z</i></b> label to a double bond, the <b><a href="toolbars.htm#stereo">Calculate stereo</a></b> button of the <b>General</b> toolbar should be used. 
	The <b><i>R/S</i></b> and <b><i>E/Z</i></b> labels are determined <i>via</i> webservice.</p>
	
<h3><a id="optical" class="anchor"></a>Optical isomerism</h3>
<p>Optical isomers of a molecule differ in the configuration of their chiral atoms (<i>e.g.</i>, a carbon atom with four different substituents). 
	Absolute configuration of a chiral center can be marked by <b><i>R</i></b> or <b><i>S</i></b> stereo labels. 
	If a carbon atom has four different substituents (or three different substituents and an implicit hydrogen) and at least one of them connects to the chiral carbon with a wedge bond, 
	the <b><i>R</i></b> or <b><i>S</i></b> label can be calculated using the Cahn-Ingold-Prelog priority rules (CIP convention).</p>
<p>Molecules with one chiral center have two optical isomers (enantiomers) which are the mirror images of each other, but they are not superposable. 
	Enantiomers differ in the absolute configuration of each of their chiral centers.<br>
	<img src="marvinjs_chem_files/stereo_1.png"></p>
	
<h3><a id="geometric" class="anchor"></a>Geometric isomerism</h3>
<p>The reason behind geometric isomerism of alkenes is that rotation around double bonds is hindered, so the position of the double bond substituents is fixed relative to each other. 
	When both double bonded carbon atoms have two different substituents, we can distinguish two non-identical geometric isomers, which are denoted by <b><i>E</i></b> and <b><i>Z</i></b> labels, respectively. 
	These stereo labels are calculated by determining the priority of the four substituents using the CIP convention. If the higher ranked substituents are on the same side of the double, 
	the molecule is the <b><i>Z</i></b> isomers, while the <b><i>E</i></b> isomer has the higher ranked groups on opposite sides of the double bond.<br>
	<img src="marvinjs_chem_files/stereo_2.png"></p>
	
<h2><a id="query" class="anchor"></a>Query Structures</h2>
<p>Query structures are generalized structures representing a group of similar molecules which differ only in some structural elements. 
	For example, all of the molecules possess the same skeleton with a halogen atom as substituent, but it is not crucial to know which halogen exactly. 
	See more about query structures in <a href="http://www.chemaxon.com/jchem/doc/user/queryindex.html">JChem Query Guide</a>. 
	Using <a href="toolbars.htm#queryatoms2">query atoms</a> and <a href="toolbars.htm#bonds2">bonds</a> offered in Marvin JS different query structures can be designed. 
	Note that atom properties (<i>e.g.</i>, atomic charge) can be modified for the query atoms, too. The query atoms are available on the <b>Atoms</b> toolbar, under a "combo" button.</p>
<p><a id="pseudoatoms" class="anchor"></a>You can define <b>pseudo atoms</b> in your molecules. Replacing an atom with a pseudo will change it to an "Any" type query atom. 
	Some atom properties can also be associated with a pseudo atom on the <a href="marvinjs_basic.htm#atomproperties">Atom properties</a> dialog.</p>

<h3><a id="absolute" class="anchor"></a>Absolute stereo information</h3>
<p>The "Absolute" chiral flag on a molecule indicates that every chiral center marked with wedge bonds has a known absolute configuration, that is to say, the structure represents a single, well-defined stereoisomer. 
	This chiral flag can be added to a molecule through the <a href="popups.htm#editPopUp">pop-up menu</a> and its display can be turned on/off in the 
	<a href="marvinjs_basic.htm#structuredisplayoptions">View settings</a> dialog window.</p>
<p>Depending on the file format, a molecule which has wedge bonds without a chiral flag has either of the following meanings:<br>
	<ul>
		<li>In MDL file types (MOL, SDF, ...): wedge bonds describe the relative configuration of chiral centers; the structure is a racemic mixture of two enantiomers.</li>
		<li>In Daylight file types (SMILES, SMARTS): wedge bonds describe the absolute configuration of chiral centers; the structure represents a single enantiomer.</li>
	</ul></p>

<h3><a id="enhanced" class="anchor"></a>Enhanced stereo specifications</h3>
<p>Marvin JS supports the MDL enhanced stereo representation. Enhanced stereo specifications enable us to refer to several stereoisomers of a molecule by drawing only one structure. 
	Attaching these notations to chiral centers makes it possible to represent stereochemical information: whether we know the absolute configuration of a stereogenic center or 
	we have information only about the relative configuration of two or more chiral atoms. The advantage of enhanced stereo representation is the most palpable when the molecule contains several chiral centers. 
	Illustrating all or even just a few of the molecules stereoisomers can be really demanding in a case like this, but with the help of enhanced stereo specifications only one molecular structure can be enough 
	to represent every isomer.</p>
<p>Marvin JS applies four identifiers, which help us to create groups from the stereocenters. Each group label consists of an identifier, and – in some cases – of a number. 
	Each and every stereocenter belongs only to one stereogenic group. The following identifiers can be attached to stereogenic centers:<br>
	<ul>
		<li>Off: We have no information about the configuration of the chiral atom;</li>
		<li>Abs: We know the absolute configuration of the chiral center;</li>
		<li>Or: Attaching the "Or" identifier to a stereogenic center means that we only know the configuration of the atom relative to another chiral center, but we do not have information about the absolute configuration. 
			For a molecule with two chiral centers it either refers to the structure as drawn (<i>e.g.</i>, <b>1<i>R</i></b>, <b>2<i>R</i></b> configuration) or to its enantiomer, 
			which has opposite configuration on its chiral atoms (<b>1<i>S</i></b>, <b>2<i>S</i></b>);</li>
		<li>And: We use the "And" notation if we want to represent a mixture of stereoisomers which can contain specified enantiomers/diastereomers or even every optical isomer.</li>
	</ul></p>
<p>You can find a more detailed description of enhanced stereo representation along with a set of examples in the 
	<a href="http://www.chemaxon.com/jchem/doc/user/query_stereochemistry.html#mdl_enhanced_stereo">JChem Query Guide</a></p>
<p>Please note that import and export of enhanced stereo notations are not possible in MDL Molfile V2000 format, only in the extended MDL Molfile (V3000) format (provided that the relevant webservice is available).</p>

<h3><a id ="list" class="anchor"></a>Atom Lists and NOT Lists</h3>
<p>You can add an "Atom List" query atom to your molecule, which covers a set of atoms. The created structure produces a hit if any of the atoms in the list is found in the target. 
	Similarly, you can use "NOT List" query atoms, too. A NOT List query atom can represent any atom that is not part of the list.</p>
<p>Atom Lists and NOT Lists can be defined using the <a href="toolbars.htm#periodictable2">Periodic Table</a>. Pressing the appropriate button on the dialog then clicking on the atoms one after the other prepares the list. 
	Close the Periodic Table when you are ready: the list of atoms is on the cursor. Furthermore, you can replace an atom with a new list or modify an already existing list in the 
	<a href="marvinjs_basic.htm#atomproperties">Atom properties</a> dialog, by selecting 'List/NOT list' at the top of the dialog.</p>
	
<h3><a id="rGroup" class="anchor"></a>R-group queries</h3>
<p>A query with an R-group represents substitution variation on the same root structure. An R-group query can involve several derivatives which differ in one or more substituents. 
	Follow the steps below to create an R-group query with Marvin JS. You can also watch a video tutorial <a href="https://www.youtube.com/watch?v=PjP5ApgrjSM">here</a>.<br>
	<ol>
		<li>The molecule containing an R-group is the "scaffold". Using the <a href="toolbars.htm#r-groups"> "combo" button</a> on the <b>Atoms</b> toolbar, 
			an R-group with any arbitrary number between 1 and 10 as well as an R-group without a number can be added to the root structure in much the same way as atoms are inserted. 
			Using the default option of the <b>R-group</b> combo button (<img src="gui/icons/r_group_2.png">) or, alternatively, typing <b>R+Space</b> opens a dialog where you can give any preferred number 
			(or leave it empty to get an R-group without any number). Existing atoms can be replaced by R-group labels using the <a href="marvinjs_basic.htm#atomproperties">Atom properties</a> dialog as well, 
			where the 'R-group' type should be chosen instead of "Element".<br>
			<img src="marvinjs_chem_files/rgroup_create_1.png"></li>
		<li>In order to create the definition for an R-group, draw the substituents for which the R-group can stand for, select them, and set the relevant R-label with the help of the same options as in the previous step 
			(using the <b>R-group</b> toolbar button or the keyboard). The <a href="popups.htm#rLabelPopUp">contextual menu items of the R-label</a> offer options to manage R-group definitions: 
			you can ungroup or delete or add fragments to a definition list, or remove fragments from a definition.<br>
			<img src="marvinjs_chem_files/rgroup_create_2.png"></li>
		<li>You can add attachment points to the fragments in an R-group definition by using the <b><a href="toolbars.htm#rAttachment">R-group attachment point</a></b> button on the <b>Atoms</b> toolbar 
			and clicking on an atom in a definition list. The attachment points on every separate fragment are automatically numbered beginning with "1".<br>
			<img src="marvinjs_chem_files/rgroup_create_3.png"></li>
		<li>The bond type of the R-group attachment points can be changed using either the R-group attachment point tool or any of the bond tools.</li>
	</ol></p>
<p>You can edit your R-group definitions by adding fragments to or removing fragments from them. In order to remove a fragment from a group, select this fragment, right-click on the R-label of the group, and select 
	<b>"Remove from this group"</b>. If you want to add one or more fragments to an R-group definition, select these fragments, right-click on the R-group label, and choose the <b>"Add to this group"</b> option.</p>
<p>If you do not wish to have an R-group definition any longer, you should right-click on the R-group label, and use the <b>"Ungroup"</b> option in the pop-up menu. 
	This way, the fragments themselves will not be erased, but they will not belong to an R-group definition any longer.</p>
<p>Please note that, for the time being, R-group definition import and export are possible only in ChemAxon Marvin Document (MRV) format or in MDL Extended Molfile (V3000) format 
	provided that the relevant webservice is available.</p>
	
<h3><a id="homology" class="anchor"></a>Homology groups</h3>
<p>Built-in homology groups of Marvin JS represent series of chemical compounds with the same specific structural properties. 
	Among these groups there are homologous series groups such as alkyl, alkenyl, alkynyl, carboalicyclyl and other generalized chemical names, like alkali and transition metal <i>etc</i>. 
	Please, <a href="http://www.chemaxon.com/marvin/help/calculations/homologygroups.html#definition">follow this link</a> for the complete list of built-in homology groups as well as their aliases (shortened names).</p>
<p>Homology groups are available from the <a href="marvinjs_basic.htm#atomproperties">Atom properties</a> dialog after a right-click on an atom. 
	At the top of the dialog, change to "Homology Groups" instead of "Element" then select the appropriate group from the list and choose either its full name or its alias at the "Display" option.</p>

	
	
</body>
</html>
